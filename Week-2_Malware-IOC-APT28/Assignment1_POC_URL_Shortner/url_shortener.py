from flask import Flask, request, redirect, render_template_string
import random
import string

app = Flask(_name_)

# Store URL mappings in memory
url_map = {}

# HTML template for the form
HTML_PAGE = """
<!DOCTYPE html>
<html>
<head>
    <title>Simple URL Shortener</title>
</head>
<body style="font-family: Arial; margin: 50px;">
    <h1>ðŸ”— Simple URL Shortener</h1>
    <form method="POST" action="/shorten">
        <input type="url" name="long_url" placeholder="Enter your long URL" size="50" required>
        <button type="submit">Shorten</button>
    </form>

    {% if short_url %}
        <p>Short URL: <a href="{{ short_url }}" target="_blank">{{ short_url }}</a></p>
    {% endif %}
</body>
</html>
"""

def generate_slug(length=6):
    """Generate a random slug of given length."""
    characters = string.ascii_letters + string.digits
    return ''.join(random.choices(characters, k=length))

@app.route("/", methods=["GET"])
def index():
    return render_template_string(HTML_PAGE)

@app.route("/shorten", methods=["POST"])
def shorten():
    long_url = request.form["long_url"]
    slug = generate_slug()
    while slug in url_map:
        slug = generate_slug()
    url_map[slug] = long_url
    short_url = request.host_url + slug
    return render_template_string(HTML_PAGE, short_url=short_url)

@app.route("/<slug>")
def redirect_to_url(slug):
    long_url = url_map.get(slug)
    if long_url:
        return redirect(long_url)
    return "Error: Short URL not found", 404

if _name_ == "_main_":
    app.run(debug=True)